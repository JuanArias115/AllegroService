<div class="space-y-4">
  <div class="flex flex-wrap items-center justify-between gap-3">
    <h2 class="text-xl font-bold">Products</h2>
    <button class="rounded-lg bg-slate-900 px-4 py-2 text-sm font-semibold text-white" (click)="openCreate()">New product</button>
  </div>

  <div class="rounded-xl bg-panel p-3 shadow-card">
    <input
      type="text"
      [value]="search"
      (input)="onSearch($any($event.target).value)"
      placeholder="Search by SKU or name"
      class="w-full rounded-lg border border-slate-300 px-3 py-2"
    />
  </div>

  <app-data-table
    [columns]="columns"
    [rows]="rows"
    [loading]="loading"
    [page]="page"
    [pageSize]="pageSize"
    [total]="total"
    (pageChange)="onPageChange($event)"
    (edit)="openEdit($event)"
    (remove)="remove($event)"
  ></app-data-table>
</div>

<app-modal [open]="modalOpen" [title]="selectedId ? 'Edit product' : 'Create product'" (close)="modalOpen = false">
  <form class="grid gap-3 md:grid-cols-2" [formGroup]="form" (ngSubmit)="submit()">
    <app-form-field label="SKU">
      <input class="w-full rounded-lg border border-slate-300 px-3 py-2" formControlName="sku" />
    </app-form-field>

    <app-form-field label="Name">
      <input class="w-full rounded-lg border border-slate-300 px-3 py-2" formControlName="name" />
    </app-form-field>

    <app-form-field label="Category">
      <select class="w-full rounded-lg border border-slate-300 px-3 py-2" formControlName="categoryId">
        <option value="">Select category</option>
        <option *ngFor="let category of categories" [value]="category.id">{{ category.name }}</option>
      </select>
    </app-form-field>

    <app-form-field label="Unit">
      <input class="w-full rounded-lg border border-slate-300 px-3 py-2" formControlName="unit" />
    </app-form-field>

    <app-form-field label="Sale price">
      <input type="number" step="0.01" class="w-full rounded-lg border border-slate-300 px-3 py-2" formControlName="salePrice" />
    </app-form-field>

    <app-form-field label="Cost price">
      <input type="number" step="0.01" class="w-full rounded-lg border border-slate-300 px-3 py-2" formControlName="costPrice" />
    </app-form-field>

    <label class="flex items-center gap-2 text-sm text-slate-700">
      <input type="checkbox" formControlName="isActive" />
      Active
    </label>

    <label class="flex items-center gap-2 text-sm text-slate-700">
      <input type="checkbox" formControlName="trackStock" />
      Track stock
    </label>

    <div class="md:col-span-2 flex justify-end gap-2 pt-2">
      <button type="button" class="rounded-md border border-slate-300 px-4 py-2 text-sm" (click)="modalOpen = false">Cancel</button>
      <button type="submit" class="rounded-md bg-slate-900 px-4 py-2 text-sm font-semibold text-white" [disabled]="saving">
        {{ saving ? 'Saving...' : 'Save' }}
      </button>
    </div>
  </form>
</app-modal>
