<div class="space-y-4">
  <div class="flex flex-wrap items-center justify-between gap-3">
    <h2 class="text-xl font-bold">Locations</h2>
    <button class="rounded-lg bg-slate-900 px-4 py-2 text-sm font-semibold text-white" (click)="openCreate()">New location</button>
  </div>

  <div class="rounded-xl bg-panel p-3 shadow-card">
    <input
      type="text"
      [value]="search"
      (input)="onSearch($any($event.target).value)"
      placeholder="Search location"
      class="w-full rounded-lg border border-slate-300 px-3 py-2"
    />
  </div>

  <app-data-table
    [columns]="columns"
    [rows]="rows"
    [loading]="loading"
    [page]="page"
    [pageSize]="pageSize"
    [total]="total"
    (pageChange)="onPageChange($event)"
    (edit)="openEdit($event)"
    (remove)="remove($event)"
  ></app-data-table>
</div>

<app-modal [open]="modalOpen" [title]="selectedId ? 'Edit location' : 'Create location'" (close)="modalOpen = false">
  <form class="grid gap-3 md:grid-cols-2" [formGroup]="form" (ngSubmit)="submit()">
    <div class="md:col-span-2">
      <app-form-field label="Name">
        <input class="w-full rounded-lg border border-slate-300 px-3 py-2" formControlName="name" />
      </app-form-field>
    </div>

    <app-form-field label="Type">
      <select class="w-full rounded-lg border border-slate-300 px-3 py-2" formControlName="type">
        <option *ngFor="let option of locationTypeOptions" [value]="option.value">{{ option.label }}</option>
      </select>
    </app-form-field>

    <app-form-field label="Unit (optional)">
      <select class="w-full rounded-lg border border-slate-300 px-3 py-2" formControlName="unitId">
        <option value="">No unit</option>
        <option *ngFor="let unit of units" [value]="unit.id">{{ unit.name }}</option>
      </select>
    </app-form-field>

    <div class="md:col-span-2 flex justify-end gap-2 pt-2">
      <button type="button" class="rounded-md border border-slate-300 px-4 py-2 text-sm" (click)="modalOpen = false">Cancel</button>
      <button type="submit" class="rounded-md bg-slate-900 px-4 py-2 text-sm font-semibold text-white" [disabled]="saving">
        {{ saving ? 'Saving...' : 'Save' }}
      </button>
    </div>
  </form>
</app-modal>
